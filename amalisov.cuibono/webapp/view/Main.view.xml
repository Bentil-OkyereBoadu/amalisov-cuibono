<mvc:View
    controllerName="amalisov.cuibono.controller.Main"
    height="100%"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns:svm="sap.ui.comp.smartvariants"
    core:require="{
		formatter: 'amalisov/cuibono/model/formatter'
	}"
>
    <f:DynamicPage headerExpanded="{/headerExpanded}">
        <f:title />

        <f:header>
            <core:Fragment
                fragmentName="amalisov.cuibono.view.fragments.TrancheFilter"
                type="XML"
            />
        </f:header>
        <f:content>
            <Table
                id="Table"
                class="trancheTable"
                width="auto"
                items="{
                        path: 'tranches>/BonusTranche',
                        sorter: {
                            path: 'createdAt',
                            descending: true
                        },
                        parameters : {$expand:'targets'}
                    }"
            >
                <headerToolbar>
                    <Toolbar class="sapUiSmallMarginBottom">
                        <Title text="{i18n>trancheTableHeader}" />

                        <ToolbarSpacer />

                        <Button
                            text="{i18n>createTranche}"
                            class="btn"
                            press=".onCreateNewTranche"
                        />
                        <Button
                            icon="sap-icon://sort"
                            id="sortParticipant"
                            press=".onOpenSortDialog"
                        />
                        <core:Fragment
                            fragmentName="amalisov.cuibono.view.fragments.TrancheSorter"
                            type="XML"
                        />
                    </Toolbar>
                </headerToolbar>

                <columns>
                    <Column width="12%">
                        <Label text="{i18n>Status}" />
                    </Column>
                    <Column>
                        <Label text="{i18n>trancheName}" />
                    </Column>
                    <Column>
                        <Label text="{i18n>trancheLocation}" />
                    </Column>
                    <Column>
                        <Label text="{i18n>startDate}" />
                    </Column>
                    <Column>
                        <Label text="{i18n>endDate}" />
                    </Column>
                    <Column width="10%" />
                </columns>

                <items>
                    <ColumnListItem vAlign="Middle">
                        <Text text="{tranches>Status}" />
                        <Text text="{tranches>name}" />
                        <Text text="{tranches>location}" />
                        <Text
                            text="{tranches>startDate}"
                        />
                        <Text
                            text="{tranches>endDate}"
                        />
                        <HBox>
                            <Button
                                icon="sap-icon://edit"
                                class="mainIcon"
                                press=".onEditPress"
                                enabled="{path: 'tranches>Status', formatter: 'formatter.statusEnabled', targetType:'any'}"
                            />
                            <Button
                                icon="sap-icon://copy"
                                class="mainIcon"
                                press=".onDuplicate"
                            />
                            <Button
                               icon="sap-icon://delete"
                               class="mainIcon"
                               press=".onDeleteTranche"
                               enabled="{path: 'tranches>Status', formatter: 'formatter.statusLocked', targetType:'any'}"
                            />
                        </HBox>
                    </ColumnListItem>
                </items>
            </Table>
        </f:content>
    </f:DynamicPage>
</mvc:View>
